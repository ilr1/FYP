function [y1,xf1] = myNeuralNetworkFunction(x1,xi1)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 14-Aug-2020 17:34:47.
%
% [y1,xf1] = myNeuralNetworkFunction(x1,xi1) takes these arguments:
%   x1 = 26xTS matrix, input #1
%   xi1 = 26x2 matrix, initial 2 delay states for input #1.
% and returns:
%   y1 = 26xTS matrix, output #1
%   xf1 = 26x2 matrix, final 2 delay states for input #1.
% where TS is the number of timesteps.

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1.55934220501743;-1.41844518629015;-3.15793036489056;-2.49196172054797;-2.86658964549187;-5.59136918543864;-3.33240561507014;-3.05291602299936;-2.83893696839518;-2.84782532887088;-2.57755333668487;-2.78132722498538;-3.05620800857162;-2.42414682464477;-2.70495316608891;-2.90280148483439;-2.73589782777093;-2.7240466807272;-2.73128904836249;-2.73655622482955;-2.55845982230125;-2.52751516108299;-2.51138443343274;-2.91860301483895;-2.45640827999785;-2.91465263233131];
x1_step1.gain = [0.720425541433046;0.747551099110661;0.39388935444125;0.409665850634642;0.346173340954262;0.223547240587172;0.303402965886574;0.309666088585873;0.360447552116424;0.336695894375929;0.367445352951022;0.355532674312085;0.348676788130454;0.38183277463495;0.366824223046703;0.355220930044039;0.35295076660001;0.354578125914978;0.3797090224565;0.361799819585781;0.392819332968647;0.381425313011316;0.388449034331456;0.362339386478499;0.396045828712179;0.36342313614264];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.052220634692437872815;0.004519661060400380348;0.298589390248219122;0.16824865959942295057;-0.37800321697779998287;0.10366776682198028392;0.014404031294134787139;-0.1547592025867691734;-0.0019223010508273297159;0.10349807947645527084];
IW1_1 = [-0.0024748198359053328634 -0.00010705679970793419132 -0.00019997332180842988412 6.3309804911993570087e-05 -0.00039255247052940255535 0.089200863711524830402 -0.0011950593578346063988 -0.00097535685489221759462 -4.2463343095057833531e-05 -0.00068836049160826630507 -0.00038878416945196990831 0.00019135298505608836829 0.00018883740893547317939 -0.00050570810413325952785 0.00046511419141988404567 0.019039024032256365859 -0.00081467584533122000979 -0.0001276657856967160535 -0.0012041861020314367867 -0.0010963243391806361347 0.00031783364086559605551 -0.00030503821712842032121 8.2733121940220218701e-05 0.00044439264512075076158 3.2138879866484476914e-05 0.00089225027848730117594 0.0021247711919199032717 0.00011281069050248418288 0.00021439618727377325602 -5.5569092151898778656e-05 0.0001699160755263347429 -0.044626690591689381626 0.00057212974348493388001 0.0004699711575339280854 4.6208804057272964255e-06 0.00035568263885228320904 0.000184282236914752812 -9.2532743198822024581e-05 -8.3255778594899573623e-05 0.00024465315956347105522 -0.00023058288224617374965 -0.0096234901706920648184 0.00040252686010369708759 5.3021898861807183103e-05 0.0006139655626894738533 0.0005491879890582608819 -0.00015307672421277333796 0.00014894940011378189583 -3.8106048053676703548e-05 -0.00023015057598149097425 -1.7831182195414895745e-05 -0.00045783164517423143719;0.00010365527276715402034 4.3566093200430824921e-06 2.4308536264887820662e-05 -0.00014920537474030670286 0.021254808828101448559 0.0027510075165074212265 -0.0090403906688778252337 0.00015205877741856759096 -0.00014418516484174785262 -2.1205086055329950228e-05 0.0040489329109745309312 -0.00011363628558357803373 0.00016729575427726093369 -0.00028088041307212707537 -3.6114116133557320077e-05 0.00056772069830218145191 -0.00024805893993728593853 0.0003869461768439119557 5.5117488626670945405e-05 0.00013314905138108389885 -0.00012194879850080747271 1.6692262253492795315e-06 -0.0003953483214314818645 0.00010973003172031655359 -4.1468137586907724589e-05 -0.00097875450521662816367 -0.00011475796638092485339 -4.1097308119432083225e-06 -2.1778325685212926536e-05 7.7212182066851292594e-05 -0.010640384750058554456 -0.0013860416482591685332 0.0045319826802243771968 -7.4304771620942053562e-05 7.3071081591626743982e-05 9.5484232027162815746e-06 -0.0020325349207260803505 5.6936194105650103441e-05 -8.5018135692283802979e-05 0.00014189611447601067299 1.8155162328796192311e-05 -0.00028899635517481411578 0.00012605559121900718048 -0.00018466142194401407033 -2.8093700101824956196e-05 -6.6779115082132482024e-05 6.1406341033712799724e-05 -2.8522632105651055971e-07 0.00017743196644142065458 -5.5417680835466727571e-05 2.1354316875082365651e-05 0.00049989798991380209481;-0.00016499809941742844019 -3.3857991705282571834e-06 1.1398185933633771323e-05 -0.0002091904305453310439 -1.7265981054774495203e-05 -5.9371693213213825951e-05 0.00010523927799948111473 -4.939839979049675926e-05 0.00019143124575360257128 0.00021416570263227069164 -5.2790563845095336848e-05 0.016816758367738663532 7.8726591852252067591e-05 -0.0001627256255462175658 8.1206181077522494855e-06 -2.8024289322657760411e-06 0.00018590804022323650794 -0.00011870309046954287304 -0.0001692521939493528871 -3.2779822472942507278e-05 -3.8903613433916100453e-05 -0.00024929494305826673407 -0.00011773661521003180204 0.00013252776573668612254 -1.6464615001042639191e-05 -0.00011650188204839821661 0.00016350006126720635874 6.6453419350175394102e-06 4.9680498279530079143e-06 0.00010252139391795132102 6.0884440226575167778e-06 4.0974848323121328489e-05 -5.5029438444191527329e-05 2.2984426784457897831e-05 -9.7295403721144523793e-05 -0.00010646457598471585778 2.5264433995481514156e-05 -0.0084517371470913087161 -3.8404012840210828442e-05 8.1086371704109077435e-05 -3.7978240147175054685e-06 2.5107535010667762136e-06 -9.4623473420848915223e-05 5.8723826536969773733e-05 8.6057198335682004225e-05 1.6256063267739817146e-05 2.0461971074860218524e-05 0.00012581968756572765606 5.9940515380965787926e-05 -6.764797434248330727e-05 7.982022713919901177e-06 5.8983948365154528813e-05;0.00021662497242944548444 -0.00012195903426872594798 4.2813237039667345607e-05 -0.00016135868377620168467 -0.00014268216526221874575 0.00044785210640911572505 -0.00010110924662589454903 0.015768495636489188172 -2.169270256589728968e-05 -5.2549098601719496093e-05 -0.00013840573481497609257 -3.2438476090069247304e-05 4.0812459839820126786e-05 5.226228530173713903e-05 -3.6545954871556752945e-05 0.00012987635988310992701 -5.4276984632337733948e-05 8.2502400788266199209e-05 -9.4906595039060954837e-05 4.5715133470309266223e-05 -4.3810101747876856691e-05 4.2912719991651963121e-05 -6.129639977994851593e-05 -0.0001131177059044125141 -2.2961813031234211017e-05 -4.8108503966001313362e-07 -0.00022198203092907610326 5.8019360531856723612e-05 -3.7740806574930313975e-05 8.3558344424547790043e-05 7.4858999396685966372e-05 -0.00023975611592535304322 5.4275745361926813249e-05 -0.0079036854345111984266 1.2899256929570366824e-05 2.5106121326354239898e-05 7.1215779030630126903e-05 1.5790347961704645919e-05 -2.2243564887013193539e-05 -2.5203189080280460801e-05 1.8203729242449671866e-05 -6.6964980065669521157e-05 2.8593607512038246354e-05 -3.9972470220049695117e-05 4.7294736617000013399e-05 -2.247670034802024184e-05 2.1139472336239421721e-05 -2.0950793657330693076e-05 3.0746734850682461116e-05 5.8021542668084546837e-05 1.2077619173486201339e-05 7.9597528921636442352e-07;-0.00029769141491328720596 -1.774594856546182829e-05 -3.5682451879161975322e-06 9.58892962494200179e-05 5.4007418821615233275e-05 -0.00020638249515244204185 2.0088447745385087961e-05 4.6432297933554182452e-05 -0.00024009174662319727046 0.0012026082776912196039 -8.0256745186646694839e-05 -4.6727126171460603378e-05 0.00037647595224074461955 0.00033811128278987776646 -1.9498004016032114072e-05 -4.5411624063611655646e-05 4.8582188427625963394e-05 7.5732971722881100955e-05 -7.0450708001907661978e-05 -0.016725122527740575451 2.9064570955951129203e-05 -4.3538135918458341388e-05 -0.00020462927636270478366 -0.00054477853216532493019 -0.00012135868365512461674 -0.0003221763568434884875 0.00029206737026482256685 1.9186627860827458946e-05 2.2192799600446253135e-05 -5.0836249994683211143e-05 -3.1322194576319489345e-05 0.0001230532046845435139 -1.4176719656045462252e-05 -2.6090283554450328614e-05 0.00011793887653637178693 -0.00060175704733075332208 3.8479132615570829916e-05 2.3809773124140342135e-05 -0.00018724848441155990311 -0.00017161026475462750132 1.0088247213355430574e-05 2.4746754104767783192e-05 -2.5997789450102425752e-05 -4.0091048047989306382e-05 3.6521011629038198192e-05 0.0084610084157185089931 -1.3499055883055128516e-05 2.1066782369228445143e-05 0.00010438335025405719603 0.00027607529860063496994 6.1173353131847038686e-05 0.0001633129327921400086;-0.0013149485734937581532 -8.1450399865911108591e-05 -0.00026126953426653483012 0.00014028887673828149829 -0.00014053147423549909654 -0.0032555061814266584436 -0.00026831407836349155122 -0.00021896679981347455502 0.00080015573243208621204 -0.00041143405615535241348 0.00032952055810974979723 5.7652541493014252517e-06 -6.2387667935543758839e-05 -0.00026891845245135339052 0.00020613619530833324689 0.057165412428361435382 -0.0014974709752009704184 -0.00058227889055410255933 -0.00074783546182425578337 -0.00045702222318478593569 0.00048018455558664074889 -0.00081519295294869571333 0.00015479535607520450284 0.00059148270926516618388 -0.00029624119221815278357 0.0015290716465927790043 0.0013252492563871000504 8.6622224373430572976e-05 0.00022286299575570482851 -8.7485583151500483936e-05 4.7733447539577566359e-05 0.0017302063940260444062 0.00011338435153958300379 9.5758675803137856914e-05 -0.00041386990394163126854 0.00021609130863703502538 -0.00017539098187708475102 -4.0786428369445025801e-07 4.0847621381783610071e-05 0.00012827162291982683717 -0.00010209512164614825041 -0.028801633318753402241 0.00074808678443092615964 0.00028539034321626378975 0.0003831279343726976829 0.00022623283228018849136 -0.00023816938345918306974 0.00040909999532795802762 -7.5144660881136177209e-05 -0.00030393591937926935304 0.00014800454599676727651 -0.00078261039161240406135;-0.00015406277675302724453 -4.3331309109417479223e-06 -3.9646082578024557062e-05 3.616598300196539172e-06 -0.0015148639104748283166 -0.003678196883781495799 -0.0092621187713412458237 -0.00048124598775614721088 -0.00011944575614651819432 -0.00037315720914860706211 -0.011778290313825871827 -2.1033485610078482238e-05 7.539731130895862925e-05 -7.1416036376528845985e-05 0.00010056795281106888247 -0.00073131450124161629951 0.00026236255068897915144 0.00042054044927809249412 -6.1848215521472923117e-05 -0.00031785499500939221789 6.5156504087279592478e-05 -0.00015525774397137905784 3.4663149628255264631e-05 8.7055794829819527908e-05 -4.8574957528681052645e-05 0.0036428426061203924603 0.00017272328377988701957 8.4395061492864915416e-06 3.4037066093941042923e-05 -5.1552066218774409884e-06 0.00075556092419215245028 0.0018556598895140916788 0.0046387606922151285518 0.00023896599706853637718 5.8090892033098579363e-05 0.00018857717241531538987 0.0059134304631290636467 1.0981577474579553758e-05 -3.6462373710680068143e-05 3.4846969115429423823e-05 -5.0533128481273416484e-05 0.00037261613144530698893 -0.0001337546629676964003 -0.00020325656309531825081 3.1964935767384052554e-05 0.00016011070826933373632 -3.2208876997584221012e-05 7.8220580011210751894e-05 -1.5717877480826144632e-05 -4.4865878879964856394e-05 2.4218824642772075111e-05 -0.0018590187896014296384;0.00035011023526459420386 9.6966844021771448828e-06 -5.5860692590089632958e-05 -0.00014173252397818019853 3.70449635600498235e-05 -0.0004374992714222566254 6.1909953524867997578e-05 9.4779426907024916715e-05 -0.0010702661429875855864 0.0071971397328230470036 -0.0002856917918274573618 -0.00010185041540631864618 -0.017970387816060084951 0.0001937788198515490634 -0.00011212135781705385182 -2.3429133616615478529e-05 0.00070343854640573513434 -9.9234005026188103139e-05 -0.00032816534669155518391 0.00054217059152892449741 0.00013082381969130839078 0.00038759252961204863214 -5.5165970416971393765e-05 3.4823613213202690914e-05 0.00014976779733729829566 -0.00041492555200409913033 -0.00034459631282738266943 -1.6046121506162602658e-05 4.2672379201792261423e-06 7.5920647600343201867e-05 -1.2959828826449620496e-05 0.00019643037502005473885 -2.579680859677502871e-05 -4.3596154397856432395e-05 0.00054032180367081063862 -0.0036146141451197251991 0.0001461164933303840121 5.023064213512392842e-05 0.0090359142816929857028 -9.5855054014791835266e-05 5.5967510323193054233e-05 1.0236268754225186768e-05 -0.00035320421084099334766 5.2245841928010753154e-05 0.00016467693971236442118 -0.00027323528422074419824 -6.7656373448570492936e-05 -0.00019464604247628123344 2.7234580476125060182e-05 -1.6621642487130567468e-05 -7.56252802807446669e-05 0.00021235453579178305847;-0.00011618408484978454468 -1.2934707641404583688e-05 -2.9807244594320940593e-07 0.00024082747432077958316 -0.014704334466469988832 -0.0024390089084471528943 -0.0088895780803617575894 -0.00014098348230152233014 0.00018328250181976941144 0.00030841436128793784516 0.0089815859145176996786 9.8657954591556897722e-05 -0.0001194259200795639588 0.00037241238897099481582 5.1869824858446362121e-06 -0.00054040477574628684003 -3.6006951200047113842e-05 0.00019969589916025385365 -0.0001494815079300314503 -0.00017583791188186049842 -8.4870632277215426174e-05 0.00010408602889515354204 0.00013979633195350182418 0.00010000214122966951562 7.3246525753516660137e-05 -0.0029010075119938459089 0.00012715641973737581093 9.6380603237840707193e-06 1.0343313598656487084e-05 -0.00012290217028778827502 0.0073603951762348726606 0.0012302396990794073686 0.0044532326671423089551 6.9262038305454743802e-05 -9.3037245282678808608e-05 -0.00015340410185465255745 -0.0045119267016460315109 -4.9333443344568363197e-05 6.126289095472934286e-05 -0.00018799122324521306995 -2.3314305217674824683e-06 0.00027481708622549441776 1.7277160936283956897e-05 -9.1791663013974643826e-05 7.6230549304593707232e-05 8.8348323750484403661e-05 4.357769409728554712e-05 -5.3534556075153737198e-05 -5.4938381474991218503e-05 -5.1081409905320279284e-05 -3.7339450192519638898e-05 0.0014790597106598688589;-0.00056690199998482213289 -4.5615465601508394043e-06 -0.00016219093893351672875 -0.00040932390971748624847 1.0720619098888372745e-06 -0.00021861273417220238903 -4.1237365570386359185e-05 -1.487098958089090619e-05 -0.00025017745958277686456 0.00074839490091034945908 -0.00016034753151462544552 -8.3980941881917016336e-05 0.00041449269262297717574 -0.00088027323810385964698 0.052861923233760439722 4.3637362003148664775e-05 0.0013495219018273528228 -0.00015436832112108048805 0.00027751555045323289626 -9.187430540095091545e-05 0.00013444194852720088465 -5.4725131661341600887e-05 -0.0002026195937098489901 0.00013696738322599679902 0.00055694649963984761958 -0.00066057596798364392066 0.00057555333233545247565 2.0760799439132813609e-05 0.00012282861088163323925 0.00019833966381590045444 -9.9022516702403890707e-06 0.00014795045847808467143 1.295034829179744792e-05 7.9965797180755353587e-07 0.0001199138754817921529 -0.00037123106749651502015 7.5972839105986988517e-05 4.2728489509903567372e-05 -0.00020511676721201733812 0.00044036195024583309112 -0.026625751994427990926 -1.8901019806112168359e-05 -0.00068375870648950082091 7.5157804699828038224e-05 -0.00013837538388235221887 4.4661178681960149429e-05 -6.5158345400451785773e-05 2.5697762070066500233e-05 0.00010409785437718220515 -7.0916603074905345638e-05 -0.00028451539265491134802 0.00033472123506191530859];

% Layer 2
b2 = [0.16834837716346198744;0.98744748851043007143;0.15857435995642460425;1.218666197150328534;0.87318663519714012633;-0.87085414106472847084;2.6884426234156668656;-21.452943062940093455;-2.0908978523530974414;8.6092375635615798757;2.0287876010396015403;-37.612218547900106103;-15.10354886583796663;1.646528017371580388;-4.0664151216718664728;-3.9615341869116926787;0.39101462952954696428;0.090556428377977435384;0.18840833594604758372;-48.538984316514131478;0.40091444659329300571;0.89607191406165376257;-0.32502525001522919457;-1.7144024782695601594;-0.20091105654034102646;-1.7894769874652716179];
LW2_1 = [-1.7602031129362463169 0.084038385826263037326 -0.071338058491813113871 -0.44401824393914995914 -0.28337063110859089798 0.60378997573866100002 0.51980712560068864647 0.11244275535480642569 0.21869633969579332922 0.061057051021443285721;0.031740505594433879311 -0.062242723830593094103 0.19097834856298151474 -6.1095158635604001063 0.078103650733096635639 0.025313091574051319738 0.18592855057799059781 -0.30315993436612193035 -0.18201730639889959762 0.090514864874976189157;0.033196284235728373835 0.08309797850075582859 0.30384355353947184453 0.13388708935165666292 0.33345527961559867647 -0.068445041865257086333 -0.074566491330981504726 -0.70362779939513508953 0.1787284512486316812 -0.06612591431890621485;0.035879078182351531456 -0.099459525098985313019 -2.1947342857149902962 -2.2441184027188794126 0.86382810170872637023 0.091784448005665972281 0.21768891989423244659 -0.99175725986588636474 1.7121139687611941493 -0.3819785486515859807;-3.7084741645327703452 60.785731833857404638 0.76152402308612598958 -1.7890301696450803259 1.7754766678193087959 0.015180401931892248749 -14.57973230948363863 0.83814159669285492882 -46.079045891312354399 0.10136062884517536842;22.057684740821766667 -0.2541717432666554255 -0.28115590150865971131 1.262603338560205346 -1.3029559999746334054 -7.433678172169768672 -1.7899227238330812639 0.43944281937847667896 -0.76025040232485519009 -0.15899192109615861712;-3.5551972026984204334 -60.168187076717700279 -0.025627491919820232641 -2.8748444576048148846 2.3467739601121020421 0.025931269321193085864 -80.141942721620438306 -0.57535277112020188905 -78.564577154839355444 0.1389717238536136712;-0.67437282849786228667 0.45900958768693950196 0.28646781435916890413 129.81045781659159388 0.4687906700167759344 -0.075129190308386523123 -1.3683680687951835786 0.30259313225291017968 -0.31641750120360950804 0.10386687728085881866;-0.24697770974275884415 -0.37589689765510370112 1.4344241572893099423 -0.2060083852232495738 -2.118457486746304852 0.55085723715356760266 -1.054666586892727409 -6.2244096988982233754 0.72590674624556039696 -0.19346812248859104888;-0.13131788399851138105 0.62763693278813159626 1.724623032408132417 -0.59973134560451146768 9.4966613299761419853 -0.14264344173888587886 -2.5563214860406091589 36.407092382305002332 1.3097935847866075676 0.54704122545347821926;-3.2170695921904384207 36.360896522695377087 -0.53098654106924669804 -3.1223994435121618096 0.74403318334840862214 0.40601969114154740081 -93.978594995658298217 -2.2734520738749171009 61.955882447022403881 0.086137812846438427394;0.057862536763830157982 0.49048738152561560666 129.01459882904518395 0.41855336237818441258 -0.35251212708800916396 -0.018114837328170586145 0.36174809069662627881 0.028050737519103759177 0.50751880420559736251 -0.050808895360719551204;-0.63798297433782036325 -0.17720781990170075826 -0.067624974423410269542 0.53594375490002854612 -0.035950429822981556927 -0.0087812494477280383237 -0.47893488515519888615 -98.013480740408780889 -0.46701486782622475546 0.040782754139489348078;-0.2709535358125098603 -0.47691660102238930818 -1.4582363623767515826 0.67594127151729477276 3.037191065212590857 -0.10500718122573618474 -0.63472959146166163524 1.2875799500490192617 1.9483744150927446714 -0.68281940213563185882;0.065049923989179220252 -0.043420941905021881446 0.09155146530091223811 0.093625573845690798769 -0.36148677489474434488 -0.013385854171324280265 -0.022994251728482514169 0.10308969716729385335 -0.07660287465903560522 37.909056216152748675;1.1115353753855192753 -0.044643582746613251488 -0.048584175964454842656 0.62958064305949135164 -0.91748544755194483269 34.61006722303415728 -0.83626332818346593712 0.47476298439404157614 -0.42784491600866869643 -0.10204794021686304506;-0.13320790103534443927 -1.0116109974491656054 1.4205818322274232912 -0.48548738984053174672 0.44784879558322282511 -0.84920922388758879329 1.7515317156353156225 3.9739201588471684268 -0.69112581579658804998 0.90261921747342177547;0.1780297454362709253 3.2537818429631961692 -0.89203172232421490406 1.0592427372669865893 0.42534454285022510467 -0.37303142820496404397 4.8258050493377702139 -0.4873568787079868847 3.5656519841665037518 -0.11662932427164407478;-0.78294567795157976597 -0.233350948541807518 -1.4940574439769362947 -1.2141786577823630022 -0.59558530696542932859 -0.30414200906638161337 -1.3487781129058820095 -2.2224581968090726392 -1.4134185364408540231 0.22039502077632841526;-0.27226762643720658907 0.17905811557194101225 -0.27403833319075104891 0.33001072990701124654 -134.83439918020289383 -0.06277516006958226702 -0.37907086490309060967 0.55496315718216648882 -0.023657080639961882568 -0.0058484443367017146381;0.17294944173379903085 -0.99887203121145606843 -0.35518433150938566456 -0.62705995525119584411 0.31001549366173436484 0.32437296958185479756 0.53218799955026718784 0.90680039029886261304 -1.0019146507607763485 0.11402618931337904495;-0.074780211939084989536 0.18456218273414740083 -2.2160973443550329165 0.52803973954428229387 -0.2917022062773970692 -0.5703072644716341566 -1.524890023546222606 2.5339386591467363274 0.53286679295181615945 -0.033224002055498226549;0.11023991830211381238 -2.098497356051127305 -1.1154774877114181919 -0.82598485132689647426 -1.9358049208974024147 0.10985482792878993596 0.24897807241189445771 -0.44592913295345704139 0.086503772725322336523 -0.16591900190576996943;0.23611276051319246561 1.0008407257505231858 1.0662108386084399037 -1.2522814366636068062 -4.488299218079601971 0.32582462246640980785 1.3627620910837059398 0.18266757082203352591 1.3844102778528801778 0.090659008922839817712;0.098509718532720197404 -0.058456814185526000116 -0.16465109575300651557 -0.30374768835294335689 -1.1583869756388645023 -0.25976264202643462031 -0.43689223249305864094 1.0605633674856644877 0.4357968017118963866 0.47193078028121060452;1.1399298354063165384 -10.132369473804327953 -0.94125274675224512855 0.45978210436972427599 -3.2039066194734506787 0.87046744747811155563 29.274660160641733597 -2.3325963611275004617 -19.027464678646058616 -0.54753738994100953352];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.720425541433046;0.747551099110661;0.39388935444125;0.409665850634642;0.346173340954262;0.223547240587172;0.303402965886574;0.309666088585873;0.360447552116424;0.336695894375929;0.367445352951022;0.355532674312085;0.348676788130454;0.38183277463495;0.366824223046703;0.355220930044039;0.35295076660001;0.354578125914978;0.3797090224565;0.361799819585781;0.392819332968647;0.381425313011316;0.388449034331456;0.362339386478499;0.396045828712179;0.36342313614264];
y1_step1.xoffset = [-1.55934220501743;-1.41844518629015;-3.15793036489056;-2.49196172054797;-2.86658964549187;-5.59136918543864;-3.33240561507014;-3.05291602299936;-2.83893696839518;-2.84782532887088;-2.57755333668487;-2.78132722498538;-3.05620800857162;-2.42414682464477;-2.70495316608891;-2.90280148483439;-2.73589782777093;-2.7240466807272;-2.73128904836249;-2.73655622482955;-2.55845982230125;-2.52751516108299;-2.51138443343274;-2.91860301483895;-2.45640827999785;-2.91465263233131];

% ===== SIMULATION ========

% Dimensions
TS = size(x1,2); % timesteps

% Input 1 Delay States
xd1 = mapminmax_apply(xi1,x1_step1);
xd1 = [xd1 zeros(26,1)];

% Allocate Outputs
y1 = zeros(26,TS);

% Time loop
for ts=1:TS
    
    % Rotating delay state position
    xdts = mod(ts+1,3)+1;
    
    % Input 1
    xd1(:,xdts) = mapminmax_apply(x1(:,ts),x1_step1);
    
    % Layer 1
    tapdelay1 = reshape(xd1(:,mod(xdts-[1 2]-1,3)+1),52,1);
    a1 = tansig_apply(b1 + IW1_1*tapdelay1);
    
    % Layer 2
    a2 = b2 + LW2_1*a1;
    
    % Output 1
    y1(:,ts) = mapminmax_reverse(a2,y1_step1);
end

% Final delay states
finalxts = TS+(1: 2);
xits = finalxts(finalxts<=2);
xts = finalxts(finalxts>2)-2;
xf1 = [xi1(:,xits) x1(:,xts)];
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
